# This file provides template inputs for use with DB Connect 3.1.X and above.
# Note: If you are using DB Connect 2.x, please consult to dbx2.inputs.conf.template

# NDOUtils tables
# Central Tables
[nagios:instances]
description = Collect Nagios instances information
interval = 120
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_instances`
sourcetype = nagios:instances

[nagios:objects]
description = Collect Nagios objects information
interval = 120
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_objects`
sourcetype = nagios:objects

# Historical Tables
[nagios:history:commenthistory]
description = Collect historical host and service comments
interval = 120
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_commenthistory` WHERE deletion_time IS NOT NULL
sourcetype = nagios:commenthistory

[nagios:history:contactnotificationmethods]
description = Collect historical records of commands methods
interval = 120
mode = rising
index_time_mode = current
query = SELECT * \
FROM `nagios`.`nagios_contactnotificationmethods` \
WHERE contactnotificationmethod_id > ? \
ORDER BY contactnotificationmethod_id ASC
sourcetype = nagios:contactnotificationmethods
rising_column_index = 1

[nagios:history:downtimehistory]
description = Collect historical records of scheduled host and service downtime
interval = 120
mode = rising
index_time_mode = current
query = SELECT * \
FROM `nagios`.`nagios_downtimehistory` \
WHERE downtimehistory_id > ? \
ORDER BY downtimehistory_id ASC
sourcetype = nagios:downtimehistory
rising_column_index = 1

[nagios:history:eventhandlers]
description = Collect historical records of host and service event handlers that have been run
interval = 120
mode = rising
index_time_mode = current
query = SELECT * \
FROM `nagios`.`nagios_eventhandlers` \
WHERE eventhandler_id > ? \
ORDER BY eventhandler_id ASC
sourcetype = nagios:eventhandlers
rising_column_index = 1

[nagios:history:hostchecks]
description = Collect historical records of "raw" and "processed" host checks
interval = 120
mode = rising
index_time_mode = current
query = SELECT * \
FROM `nagios`.`nagios_hostchecks` \
WHERE hostcheck_id > ? \
ORDER BY hostcheck_id ASC
sourcetype = nagios:hostchecks
rising_column_index = 1

[nagios:history:notifications]
description = Collect historical records of host and service notifications
interval = 120
mode = batch
index_time_mode = current
query = SELECT a.*,b.`receiver_name1`,b.`receiver_name2`,b.`receiver_objecttype` FROM (SELECT notifications.*,objects.`name1` AS sender_name1,objects.`name2` AS sender_name2,objects.`objecttype_id` AS sender_objecttype FROM `nagios`.`nagios_notifications` notifications INNER JOIN `nagios`.`nagios_objects` objects on notifications.`object_id` = objects.`object_id`) a INNER JOIN (SELECT contactnotifications.`notification_id`,contactnotifications.`instance_id`,objects.`name1` AS receiver_name1,objects.`name2` AS receiver_name2,objects.`objecttype_id` AS receiver_objecttype FROM `nagios`.`nagios_contactnotifications` contactnotifications  inner join `nagios`.`nagios_objects` objects on contactnotifications.`contact_object_id` = objects.`object_id` and contactnotifications.`instance_id`=objects.`instance_id` ) b on a.`notification_id` = b.`notification_id`
sourcetype = nagios:notifications

[nagios:history:processevents]
description = Collect historical records of Nagios process events e.g. program starts, restarts, shutdowns
interval = 120
mode = rising
index_time_mode = current
query = SELECT * \
FROM `nagios`.`nagios_processevents` \
WHERE processevent_id > ? \
ORDER BY processevent_id ASC
sourcetype = nagios:processevents
rising_column_index = 1

[nagios:history:servicechecks]
description = Collect historical records of service checks that have been performed
interval = 120
mode = rising
index_time_mode = current
query = SELECT * \
FROM `nagios`.`nagios_servicechecks` \
WHERE servicecheck_id > ? \
ORDER BY servicecheck_id ASC
sourcetype = nagios:servicechecks
rising_column_index = 1

[nagios:history:systemcommands]
description = Collect historical records of system commands that are run by Nagios daemon
interval = 120
mode = rising
index_time_mode = current
query = SELECT * \
FROM `nagios`.`nagios_systemcommands` \
WHERE systemcommand_id > ? \
ORDER BY systemcommand_id ASC
sourcetype = nagios:systemcommands
rising_column_index = 1

[nagios:history:timedevents]
description = Collect historical records of time events that Nagios process handled
interval = 120
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_timedevents` WHERE deletion_time IS NOT NULL
sourcetype = nagios:timedevents

# Current Status Tables
[nagios:status:comments]
description = Collect current host and service comments
interval = 120
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_comments`
sourcetype = nagios:comments

[nagios:status:customvariablestatus]
description = Collect current state of all custom host, service and contact variables
interval = 120
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_customvariablestatus`
sourcetype = nagios:customvariablestatus

[nagios:status:hoststatus]
description = Collect current status of host
interval = 120
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_hoststatus`
sourcetype = nagios:hoststatus

[nagios:status:programstatus]
description = Collect currently running Nagios process/daemon
interval = 120
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_programstatus`
sourcetype = nagios:programstatus

[nagios:status:runtimevariables]
description = Collect runtime variables from Nagios process
interval = 120
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_runtimevariables`
sourcetype = nagios:runtimevariables

[nagios:status:scheduleddowntime]
description = Collect current host and service downtime
interval = 120
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_scheduleddowntime`
sourcetype = nagios:scheduleddowntime

[nagios:status:servicestatus]
description = Collect current status information for all services
interval = 120
mode = batch
index_time_mode = current
query = SELECT servicestatus.*,objects.`objecttype_id`,objects.`name1`,objects.`name2`,objects.`is_active` FROM `nagios`.`nagios_servicestatus` servicestatus INNER JOIN `nagios`.`nagios_objects` objects ON servicestatus.`service_object_id`=objects.`object_id` AND servicestatus.`instance_id`=objects.`instance_id`
sourcetype = nagios:servicestatus

[nagios:status:timedeventqueue]
description = Collect all timed events that are in the Nagios event queue
interval = 120
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_timedeventqueue`
sourcetype = nagios:timedeventqueue


# Configuration Tables
[nagios:config:commands]
description = Collect configured commands
interval = 3600
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_commands`
sourcetype = nagios:commands

[nagios:config:files]
description = Collect configuration files information
interval = 3600
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_configfiles`
sourcetype = nagios:configfiles

[nagios:config:filevariables]
description = Collect configuration variables
interval = 3600
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_configfilevariables`
sourcetype = nagios:configfilevariables

[nagios:config:contact_addresses]
description = Collect contact addresses configuration
interval = 3600
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_contact_addresses`
sourcetype = nagios:contact_addresses

[nagios:config:contact_notificationcommands]
interval = 3600
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_contact_notificationcommands`
sourcetype = nagios:contact_notificationcommands

[nagios:config:contactgroup_members]
description = Collect contact groups members configuration
interval = 3600
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_contactgroup_members`
sourcetype = nagios:contactgroup_members

[nagios:config:contactgroups]
description = Collect contact groups configuration
interval = 3600
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_contactgroups`
sourcetype = nagios:contactgroups

[nagios:config:contacts]
description = Collect contacts configuration
interval = 3600
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_contacts`
sourcetype = nagios:contacts

[nagios:config:customvariables]
description = Collect custom variables configuration
interval = 3600
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_customvariables`
sourcetype = nagios:customvariables

[nagios:config:host_contactgroups]
description = Collect host contact groups relationship configuration
interval = 3600
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_host_contactgroups`
sourcetype = nagios:host_contactgroups

[nagios:config:host_contacts]
description = Collect host contact relationship configuration
interval = 3600
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_host_contacts`
sourcetype = nagios:host_contacts

[nagios:config:host_parenthosts]
description = Collect host parent host relationship configuration
interval = 3600
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_host_parenthosts`
sourcetype = nagios:host_parenthosts

[nagios:config:hostdependencies]
description = Collect host dependencies configuration
interval = 3600
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_hostdependencies`
sourcetype = nagios:hostdependencies

[nagios:config:hostescalation_contactgroups]
description = Collect host contact groups relationship configuration in case of escalation
interval = 3600
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_hostescalation_contactgroups`
sourcetype = nagios:hostescalation_contactgroups

[nagios:config:hostescalation_contacts]
description = Collect host contact relationship configuration in case of escalation
interval = 3600
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_hostescalation_contacts`
sourcetype = nagios:hostescalation_contacts

[nagios:config:hostescalations]
description = Collect host escalations configuration
interval = 3600
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_hostescalations`
sourcetype = nagios:hostescalations

[nagios:config:hostgroup_members]
description = Collect host group membership configuration
interval = 3600
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_hostgroup_members`
sourcetype = nagios:hostgroup_members

[nagios:config:hostgroups]
description = Collect host group configuration
interval = 3600
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_hostgroups`
sourcetype = nagios:hostgroups

[nagios:config:hosts]
description = Collect host monitoring configuration
interval = 3600
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_hosts`
sourcetype = nagios:hosts

[nagios:config:service_contactgroups]
description = Collect service contact groups relationship configuration
interval = 3600
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_service_contactgroups`
sourcetype = nagios:service_contactgroups

[nagios:config:service_contacts]
description = Collect service contacts relationship configuration
interval = 3600
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_service_contacts`
sourcetype = nagios:service_contacts

[nagios:config:servicedependencies]
description = Collect service dependencies configuration
interval = 3600
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_servicedependencies`
sourcetype = nagios:servicedependencies

[nagios:config:serviceescalation_contactgroups]
description = Collect service contact groups relationship configuration in case of escalation
interval = 3600
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_serviceescalation_contactgroups`
sourcetype = nagios:serviceescalation_contactgroups

[nagios:config:serviceescalation_contacts]
description = Collect service contact relationship configuration in case of escalation
interval = 3600
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_serviceescalation_contacts`
sourcetype = nagios:serviceescalation_contacts

[nagios:config:serviceescalations]
description = Collect service escalations configuration
interval = 3600
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_serviceescalations`
sourcetype = nagios:serviceescalations

[nagios:config:servicegroup_members]
description = Collect service escalations configuration
interval = 3600
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_servicegroup_members`
sourcetype = nagios:servicegroup_members

[nagios:config:servicegroups]
description = Collect service group membership configuration
interval = 3600
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_servicegroups`
sourcetype = nagios:servicegroups

[nagios:config:services]
description = Collect services configuration
interval = 3600
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_services`
sourcetype = nagios:services

[nagios:config:timeperiod_timeranges]
description = Collect time periods time ranges configuration
interval = 3600
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_timeperiod_timeranges`
sourcetype = nagios:timeperiod_timeranges

[nagios:config:timeperiods]
description = Collect time periods configuration
interval = 3600
mode = batch
index_time_mode = current
query = SELECT * FROM `nagios`.`nagios_timeperiods`
sourcetype = nagios:timeperiods
